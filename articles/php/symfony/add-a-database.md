# Add a Database

## Configure
You can add a database to your app by simply adding a data component to your `boxfile.yml`:

<div class="meta" data-class="snippet" data-optional-components="mysql,postgres" ></div>

In the above snippet `db` is the `NAME` of this component, and can be anything you choose as long as it is unique.

Nanobox generates the following environment variables based off that name:

* `DATA_DB_HOST` : autogenerated unique host ip
* `DATA_DB_USER` : user to connect with
* `DATA_DB_PASS` : unique password

**HEADS UP**: Your database will be provisioned the next time you `nanobox run`.

## Connect

#### Include the DB Driver Extension
Add the required extension to the list of extensions in your `boxfile.yml`.

```yaml
run.config:
  engine.config:
    extensions:
      - pdo_mysql
```

#### Configure Symfony

By default Symfony generates a `app/config/parameters.yml` file for database configuration.

Instead, create an `app/config/parameters.php` where the nanobox environment variables will be used to connect.

<div class="meta" data-class="configFile" data-run="app/config/parameters.php"></div>

```php
<?php

// http://nux.net/secret
$secret = getenv('SYMFONY_SECRET') || '86bc1dc4359efa409d317c45f02628d6946c767c';

// general
$container->setParameter('secret', $secret);
$container->setParameter('locale', 'en');

// database configuration
$container->setParameter('database_driver', 'pdo_mysql');
$container->setParameter('database_host', getenv("DATA_DB_HOST"));
$container->setParameter('database_port', 3306);
$container->setParameter('database_name', 'gonano');
$container->setParameter('database_user', getenv("DATA_DB_USER"));
$container->setParameter('database_password', getenv("DATA_DB_PASS"));

// mailer
$container->setParameter('mailer_transport', null);
$container->setParameter('mailer_host', null);
$container->setParameter('mailer_user', null);
$container->setParameter('mailer_password', null);
```

Now open your `app/config/config.yml` file and modify your imports at the top to include the new `parameters.php` file instead of the `parameters.yml`. It should look something like this:

```yaml
imports:
    # - { resource: parameters.yml }
    - { resource: parameters.php }
    - { resource: security.yml }
    - { resource: services.yml }
```

## Test

#### From an external client
You can connect directly to your database from an <a href="https://docs.nanobox.io/data-management/managing-local-data/" target="\_blank">external client</a>.

#### From Symfony
You can also test your connection by simply trying to run a migration.

```bash
nanobox run php bin/console doctrine:schema:update --force
```

## Now what?
Whats next? Think about what else your app might need and hopefully the topics below will help you get started with the next steps of your development!

* [Frontend Javascript](/php/symfony/frontend-javascript)
* [Local Environment Variables](/php/symfony/local-evars)
* [Back to Symfony overview](/php/symfony)

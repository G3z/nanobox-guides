# Add a Database

## Configure

To add a database to your app, simply add a data component to your `boxfile.yml`:

<div class="meta expand" data-method="snippet" data-params="data.db" ></div>

```yaml
run.config:
  engine: ruby

# add a postgres database
data.db:
  image: nanobox/postgresql
```

In the above snippet `db` is the `NAME` of this component, and can be anything you choose as long as it is unique. 

Nanobox will then generate the following environment variables:

* `DATA_DB_HOST` : autogenerated unique host ip
* `DATA_DB_USER` : user to connect with
* `DATA_DB_PASS` : unique password

These are named according to your database's name. Example : 
`DATA_<YOUR_DATABASE_NAME>_HOST`

The next time you `nanobox run` the database will be running.

## Connect

Modify your `config/database.yml` to connect your app:

<div class="meta" data-method="configFile" data-params="config/database.yml"></div>

```yaml
default: &default
  adapter: postgresql
  encoding: unicode
  pool: 5
  timeout: 5000
  host: <%= ENV['DATA_DB_HOST'] %>
  username: <%= ENV['DATA_DB_USER'] %>
  password: <%= ENV['DATA_DB_PASS'] %>

development:
  <<: *default
  database: development

test:
  <<: *default
  database: test

production:
  <<: *default
  database: production
```

## Test

#### From an external client
You can connect directly to your database from an <a href="https://docs.nanobox.io/local-dev/managing-local-data/" target="\_blank">external client</a>.

#### With rake
Or you can also test your connection from rails directly: 

```bash
nanobox run rake db:setup
```

## Now what?
Whats next? Think about what else your app might need and hopefully the topics below will help you get started with the next steps of your development!

* [Frontend Javascript](/ruby/rails/frontend-javascript)
* [Local Environment Variables](/ruby/rails/local-evars)
* [Back to Rails overview](/ruby/rails)
